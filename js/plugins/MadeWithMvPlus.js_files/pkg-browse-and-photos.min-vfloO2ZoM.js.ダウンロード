define("modules/clean/emoji_utils",["require","exports"],function(e,t){"use strict";function r(e){var t=i();t.lastIndex=0;var r=t.exec(e);if(r&&0===r.index){var n=r[0];if("‍"===e[n.length])return"";var o=t.exec(e);return o&&o.index===n.length?"":n||""}return""}function i(){return n||(n=/(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|\u25b6|\u25c0|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|[\u2600-\u26FF]|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]\ufe0f?|\ud83c\udccf|\u2934|\u2935|[\u2190-\u21ff])/g),n}Object.defineProperty(t,"__esModule",{value:!0});var n;t.getFirstEmojiFromTitle=r}),define("modules/clean/pagination_manager",["require","exports","tslib","modules/clean/ajax","modules/core/i18n","modules/core/notify"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(){function e(e){this.hasMoreItems=e}return e.prototype.areAllItemsReady=function(){return!this.hasMoreItems},e.prototype.invalidateHasMore=function(){this.hasMoreItems=!0},e.prototype.addDataToAjax=function(e){},e})(),s=(function(){function e(e){this.ajaxURL=e.ajaxURL,this.newDataCallback=e.newDataAvailableCallback,this.autoFetching=!1,this.mode=e.mode,this.keyName=e.keyName,this.items={},this.pages=[],this.nextRequestVoucher=e.firstPage.next_request_voucher,this.userID=e.userID,this.fqPathPrefix=e.fqPathPrefix?"/"+e.fqPathPrefix:"",this.addPage(e.firstPage.items)}return e.prototype.areAllItemsReady=function(){return this.mode.areAllItemsReady()},e.prototype.addPage=function(e){for(var t=[],r=[],i=0,a=e;i<a.length;i++){var s=a[i],l=s[this.keyName];if(null==l)return void o.Notify.warning(n._("Invalid server response"));null==this.items[l]&&(this.items[l]=s,r.push(s),t.push(l))}this.pages.push(t),this.newDataCallback(this,r)},e.prototype.startAutoFetching=function(){this.autoFetching=!0,this.fetchNext()},e.prototype.stopAutoFetching=function(){this.autoFetching=!1},e.prototype.reSync=function(e){void 0===e&&(e=!1),e&&(this.nextRequestVoucher=null,this.items={},this.pages=[]);var t=this.autoFetching&&this.mode.areAllItemsReady();this.mode.invalidateHasMore(),t&&this.startAutoFetching()},e.prototype.fetchNext=function(){var e=this;if(!this.mode.areAllItemsReady()){var t={};this.nextRequestVoucher&&(t.voucher=this.nextRequestVoucher),this.mode.addDataToAjax(t),i.WebRequest({url:this.ajaxURL,data:t,subject_user:this.userID,success:function(t){var r=JSON.parse(t);e.nextRequestVoucher=r.next_request_voucher,e.mode.hasMoreItems=r.has_more_items,e.autoFetching&&e.fetchNext();for(var i=0,n=r.items;i<n.length;i++){var o=n[i];o.fq_path=e.fqPathPrefix+o.fq_path}e.addPage(r.items)},error:function(){o.Notify.error(n._("There was a problem completing this request."))}})}},e.prototype.loadedPageCount=function(){return this.pages.length},e.prototype.getLoadedPage=function(e){var t=this,r=this.pages[e];return null==r?null:r.map(function(e){return t.items[e]})},e.prototype.getLastLoadedPage=function(){return this.getLoadedPage(this.loadedPageCount()-1)},e})();t.BasePaginationManager=s;var l=(function(e){function t(t){return e.call(this,r.__assign({},t,{mode:new a(t.firstPage.has_more_items)}))||this}return r.__extends(t,e),t.create=function(e){return new t(e)},t})(s);t.PaginationManager=l}),define("modules/clean/paper_formatting_utils",["require","exports","modules/clean/emoji_utils","external/react","modules/clean/filename_highlights","spectrum/icon_content"],function(e,t,r,i,n,o){"use strict";function a(e,t,i,o){var a=e.title,l=e.highlight_spans,u=e.title_highlights,c=l&&l.length>0,d=r.getFirstEmojiFromTitle(a);if(d)if(a=a.substr(d.length),c){var p={string:l[0].string.substr(d.length),is_highlighted:l[0].is_highlighted};l=[p].concat(l.slice(1))}else if(u){var h=d.length/2;u=u.slice().map(function(e){return{pos:e.pos-h,len:e.string.length,string:e.string}})}var m;return m=c?n.highlightReactFromHighlightSpans(a,l):n.highlightMatchReact(a,u),{title:a,highlightedTitle:m,icon:s(d,d?i:t,o)}}function s(e,t,r){return e?i.createElement("div",{className:"mc-media-cell-icon"},i.createElement(o.IconContent,{name:r?"blank-large":"blank-small"}),i.createElement("span",{className:t},e)):i.createElement(o.IconContent,{name:r?"paper-large":"paper-small",className:t})}Object.defineProperty(t,"__esModule",{value:!0}),t.getPaperDocTitleParts=a}),define("modules/clean/photos/thumb_loading/buffered_thumb_store",["require","exports","modules/clean/photos/thumb_loading/generic_thumb_store","modules/clean/web_timing_logger","modules/core/exception"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t){var n=this;this.isTTI=!1,this.postTTISuccesses=[],this.postTTIErrors=[],this.postTTIRequests=[],this.wrapHandlers=function(e){return{onSuccess:function(t){n.isTTI?e.onSuccess(t):n.bufferCallbacks(n.postTTISuccesses,e,t)},onRequest:function(t){e.onRequest&&(n.isTTI?e.onRequest(t):n.bufferCallbacks(n.postTTIRequests,e,t))},onError:function(){e.onError&&(n.isTTI?e.onError():n.bufferErrorCallback(e))}}},this.innerStore=new r.GenericThumbStore(e,t),i.waitForTTI().then(function(){n.isTTI=!0,n.postTTIRequests.forEach(function(e){var t=e[0].onRequest;t&&t(e[1])}),n.postTTIErrors.forEach(function(e){return e.onError&&e.onError()}),n.postTTISuccesses.forEach(function(e){return e[0].onSuccess(e[1])}),n.postTTIRequests=[],n.postTTIErrors=[],n.postTTISuccesses=[]})}return e.prototype.get_thumb=function(e){return this.isTTI?this.innerStore.get_thumb(e):null},e.prototype.is_batching=function(){return this.innerStore.is_batching()},e.prototype.bind_url=function(e,t){var r=this.isTTI?t:this.wrapHandlers(t);return this.innerStore.bind_url(e,r)},e.prototype.bufferCallbacks=function(e,t,r){n.assert(!this.isTTI,"Should not buffer callback after TTI"),e.push([t,r])},e.prototype.bufferErrorCallback=function(e){n.assert(!this.isTTI,"Should not buffer error callback after TTI"),this.postTTIErrors.push(e)},e.prototype.unbind_url=function(e){this.innerStore.unbind_url(e)},e})();t.BufferedThumbStore=o}),define("modules/clean/react/browse/util",["require","exports","modules/clean/react/browse/models","modules/clean/em_string","modules/clean/filepath","modules/core/i18n"],function(e,t,r,i,n,o){"use strict";function a(e){if(1===e.count()){var t=e.first(),r=n.filename(t.fq_path);return i.Emstring.em_snippet(r,13.5)}if(e.count()>1){var a=function(e){return e.isDeleted},s=e.some(a)&&!e.every(a),l=e.toArray().filter(function(e){return e.is_dir}),u=e.toArray().filter(function(e){return!e.is_dir});if(s)return o._("No available actions");var c=[];if(u.length){var d=o.ungettext("%(num_files)d file","%(num_files)d files",u.length).format({num_files:u.length});c.push(d)}if(l.length){var d=o.ungettext("%(num_folders)d folder","%(num_folders)d folders",l.length).format({num_folders:l.length});c.push(d)}return 2===c.length?o._("%(x)s and %(y)s",{comment:'\n            The whole string is a phrase like "2 files and 3 folders". \'x\' is\n            a string containing a phrase like "2 files" and \'y\' is a string\n            containing a phrase like "3 folders".\n          '}).format({x:c[0],y:c[1]}):c[0]}return""}function s(e,t){var i=e.count(),n=o._("You only have partial access");return i>0?1!==i||r.File.canViewFileMembers(e.first(),t)?o.ungettext("%(count)d item selected","%(count)d items selected",i).format({count:i}):r.File.isNoAccessSharedFolder(e.first())?o._("You don’t have access to this folder"):n:t&&!t.canViewContainingNSMembers?n:""}Object.defineProperty(t,"__esModule",{value:!0});t.describeFiles=a,t.getSelectedFilesText=s}),define("modules/clean/react/file_viewer/async_controller",["require","exports"],function(e,t){"use strict";function r(){Array.from(document.querySelectorAll(o)).forEach(function(e){e.style.display&&e.setAttribute("data-preview-old-display",e.style.display),e.style.display="none"})}function i(){Array.from(document.querySelectorAll(o)).forEach(function(e){e.style.display=e.hasAttribute("data-preview-old-display")?e.getAttribute("data-preview-old-display"):""})}function n(t){var r=t.containerId,i=t.files,n=t.fileViewAction,o=t.fileViewOrigin,a=t.fileViewTarget,s=t.indexOfPreviewFile,l=t.onFileViewerDidMount,u=t.onFileViewerUnmount,c=t.shouldFocusComment,d=void 0!==c&&c,p=t.updateBrowserLocation,h=void 0===p||p,m=t.user;e(["modules/clean/react/file_viewer/controller"],function(e){e.open(i,s,m,r,{fileViewTarget:a,fileViewOrigin:o,fileViewAction:n,shouldFocusCommentInput:d,disableRouting:!h,onComponentDidMount:l,onComponentWillUnmount:u})})}Object.defineProperty(t,"__esModule",{value:!0});var o=[".maestro-chrome","#maestro-nav","#page-footer","#page-header","#page-sidebar","#browse-box",".growth-onboarding-progress-bar__container",".team-progress-bar-experience","#flash-upload-container"].join();t.hideElementsBehindFileViewer=r,t.showElementsBehindFileViewer=i,t.asyncOpenPreview=n}),define("modules/clean/react/files_view/constants",["require","exports","modules/clean/react/files_view/types","modules/core/i18n"],function(e,t,r,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_PAGE_HEADER_HEIGHT=96,t.DEFAULT_COLUMN_HEADER_HEIGHT=40,t.DEFAULT_ROW_HEIGHT=72,t.DEFAULT_VIEWPORT_TOP_OFFSET=t.DEFAULT_PAGE_HEADER_HEIGHT+t.DEFAULT_COLUMN_HEADER_HEIGHT,t.COMPACT_PAGE_HEADER_HEIGHT=76,t.COMPACT_COLUMN_HEADER_HEIGHT=48,t.COMPACT_VIEWPORT_TOP_OFFSET=t.COMPACT_PAGE_HEADER_HEIGHT+t.COMPACT_COLUMN_HEADER_HEIGHT,t.PINNED_TEAM_FOLDER_SECONDARY_HEADER_PADDING_TOP=12,t.CHECKBOX_CELL_FLEX="0 0 36px",t.LIST_VIEW_COLUMN_FLEX={3:[t.CHECKBOX_CELL_FLEX,"1 1 50%","0 0 25%","0 0 25%"],2:[t.CHECKBOX_CELL_FLEX,"1 1 60%","0 0 40%"],1:[t.CHECKBOX_CELL_FLEX,"1 1 100%"]},t.LIST_VIEW_SEARCH_MODE_COLUMN_FLEX={2:[t.CHECKBOX_CELL_FLEX,"1 1 66%","0 0 34%"],1:[t.CHECKBOX_CELL_FLEX,"1 1 100%"]},t.GRID_VIEW_COLUMN_FLEX=[t.CHECKBOX_CELL_FLEX,"1 1"],t.LIST_VIEW_COLUMNS=[{sortField:r.SortField.FILENAME,label:i._("Name"),popoverTriggerLabel:i._("Name"),isLocked:!0},{sortField:r.SortField.MODIFIED,label:i._("Modified"),popoverTriggerLabel:i._("Modified")},{sortField:r.SortField.SHARED_WITH,label:i._("Members"),popoverTriggerLabel:i._("Members")},{sortField:r.SortField.CATEGORY,label:i._("Type"),popoverTriggerLabel:i._("Type")},{sortField:r.SortField.EXTENSION,label:i._("Extension"),popoverTriggerLabel:i._("Extension")},{sortField:r.SortField.SIZE,label:i._("Size"),popoverTriggerLabel:i._("Size")}],t.GRID_VIEW_COLUMNS=[{sortField:r.SortField.FILENAME,label:i._("Name"),popoverTriggerLabel:i._("Name")},{sortField:r.SortField.MODIFIED,label:i._("Modified"),popoverTriggerLabel:i._("Modified")},{sortField:r.SortField.CATEGORY,label:i._("Type"),popoverTriggerLabel:i._("Type")},{sortField:r.SortField.EXTENSION,label:i._("Extension"),popoverTriggerLabel:i._("Extension")},{sortField:r.SortField.SIZE,label:i._("Size"),popoverTriggerLabel:i._("Size")}],t.SEARCH_LIST_VIEW_COLUMNS=[{sortField:r.SortField.FILENAME,label:"",popoverTriggerLabel:"",isLocked:!0,isSortDisabled:!0},{sortField:r.SortField.MODIFIED,label:i._("Modified"),popoverTriggerLabel:i._("Modified"),isLocked:!0,isSortDisabled:!0}],t.SEARCH_LIST_VIEW_COLUMNS_DELETED=[{sortField:r.SortField.FILENAME,label:"",popoverTriggerLabel:"",isLocked:!0,isSortDisabled:!0},{sortField:r.SortField.MODIFIED,label:i._("Deleted"),popoverTriggerLabel:i._("Deleted"),isLocked:!0,isSortDisabled:!0}],t.SELECTABLE_LIST_KEY_SCOPE="FilesViewSelectableList",t.TILE_GRID_SCOPE="FilesViewTileGrid",t.SELECTABLE_LIST_LINKED_OUTSIDE_CLASSES=[".bubble-menu-item-wrapper",".browse-menu",".context-menu",".react-file-viewer",".db-modal"],t.FilesViewTileGridConstants={NUM_THRESHOLD_ROWS:10,SCROLL_DELTA_THRESHOLD:1},t.AllNewFolderCreationStates=[r.NewFolderCreationState.CREATE_FOLDER_INACTIVE,r.NewFolderCreationState.PENDING_INPUT,r.NewFolderCreationState.SAVING_INPUT],t.AllRenameStates=[r.RenameState.PENDING_INPUT,r.RenameState.SAVING_INPUT],t.AllViewTypes=[r.ViewType.Grid,r.ViewType.List],t.AllViewTypesExperiment=[r.ViewType.Grid,r.ViewType.LargeGrid,r.ViewType.List],t.ViewTypeLabels=(n={},n[r.ViewType.Grid]=i._("Grid"),n[r.ViewType.List]=i._("List"),n),t.ViewTypeLabelsExperiment=(o={},o[r.ViewType.Grid]=i._("Small"),o[r.ViewType.List]=i._("List"),o[r.ViewType.LargeGrid]=i._("Large"),o),t.AllDropTargetHighlightModes=[r.DropTargetHighlightMode.NONE,r.DropTargetHighlightMode.ALL_FOLDERS,r.DropTargetHighlightMode.NONSELECTED_FOLDERS,r.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS,r.DropTargetHighlightMode.NONSELECTED_NONSHARED_NONTEAM_FOLDERS],t.AllSortFields=[r.SortField.FILENAME,r.SortField.MODIFIED,r.SortField.CATEGORY,r.SortField.EXTENSION,r.SortField.SIZE,r.SortField.SHARED_WITH,r.SortField.SYNC_SETTING,r.SortField.FILE_COUNTS],t.SortIsFilename=[r.SortField.FILENAME,r.SortField.CATEGORY,r.SortField.EXTENSION,r.SortField.SHARED_WITH,r.SortField.SYNC_SETTING],t.AllLoadingStates=[r.LoadingState.LOADED,r.LoadingState.LOADING_FIRST_PAGE,r.LoadingState.LOADING_REMAINING_PAGES],t.AllSortDirections=[r.SortDirection.ASCENDING,r.SortDirection.DESCENDING],t.ViewTypeThumbnailSizes=(a={},a[r.ViewType.Grid]=256,a[r.ViewType.LargeGrid]=512,a[r.ViewType.List]=32,a),t.ViewTypeGridSizes=(s={},s[r.ViewType.Grid]=160,s[r.ViewType.LargeGrid]=480,s[r.ViewType.List]=0,s);var n,o,a,s}),define("modules/clean/react/files_view/drag_and_drop",["require","exports","modules/clean/react/browse/models","modules/clean/react/no-jquery"],function(e,t,r,i){"use strict";function n(e,t,r,n,o,a,l){s.add(e,"dragenter",function(e){(t()||r())&&!i.closestElement(e.target,o)&&a()&&(l(null),n())})}function o(e){s.remove(e,"dragenter")}function a(e,t,i,n,o,a,s,l){if(t||i){if(e.is_dir&&!(n&&i)){if(o)return;var u=a.isCurrentPathWriteable()&&!r.File.isReadOnlySharedFolder(e);s(e),l({path:e.fq_path,hasPermissionToUploadToFolder:u})}else s(null),l()}}Object.defineProperty(t,"__esModule",{value:!0});var s=new i.ScopedEventHandlers(document);t.setupExternalDragHandler=n,t.cleanupExternalDragHandler=o,t.onFileDragEnterItem=a}),define("modules/clean/react/files_view/file_grouper",["require","exports","modules/core/i18n","modules/clean/datetime","modules/clean/react/browse/constants","modules/clean/react/files_view/types","modules/clean/react/browse/models"],function(e,t,r,i,n,o,a){"use strict";function s(e){return e instanceof a.File?a.File.getCategoryDescription(e,!0):n.ExtensionCategories.DOCUMENT}function l(e){return e instanceof a.File?e.is_dir?n.FileTypeCapitalizedCategoryTranslations.FOLDER:a.File.getExtension(e).toUpperCase():d}function u(e){return e instanceof a.File&&e.ts?1e3*e.ts:e instanceof a.Paper?Date.parse(e.last_modified_date):0}function c(e,t,n){var a=[],c=[],h=null;if(t===o.SortField.CATEGORY)e.forEach(function(e,t){if(e){var r=s(e);r!==h&&(a.push(r),c.push(t),h=r)}});else if(t===o.SortField.EXTENSION)e.forEach(function(e,t){if(e){var r=l(e);if(r!==h){var i=r;""===r&&(i=d),a.push(i),c.push(t),h=r}}});else if(t===o.SortField.MODIFIED)if(n===o.SortDirection.DESCENDING){var m=i.getTimeBands(Date.now());e.forEach(function(e,t){if(e){var i,n=u(e);i=n>=m.today?r._("Today"):n>=m.yesterday?r._("Yesterday"):n>=m.thisWeek?r._("This week"):n>=m.lastWeek?r._("Last week"):n>=m.thisMonth?r._("This month"):n>=m.lastMonth?r._("Last month"):n>=m.lastThreeMonths?r._("Three months ago"):r._("Older"),i!==h&&(a.push(i),c.push(t),h=i)}})}else e.forEach(function(e,t){if(e){var r;if(u(e)){var n=new Date(u(e)),o=n.getMonth(),s=n.getFullYear();r=i.month_with_year(o,s)}else r=p;r!==h&&(a.push(r),c.push(t),h=r)}});return{sectionLabels:a,sectionStartIndices:c}}Object.defineProperty(t,"__esModule",{value:!0});var d=r._("Extensionless",{comment:"Label for files without extensions like .txt or .png"}),p=r._("Missing dates",{comment:"label for group of files without dates marking when they are created or modified"});t.getSections=c}),define("modules/clean/react/files_view/file_jump",["require","exports","modules/clean/keycode","modules/core/dom"],function(e,t,r,i){"use strict";function n(e,t,n,s){var l=null!=e.which?e.which:e.keyCode,u=String.fromCharCode(l);l<r.KeyCode.SPACE||o.includes(u)||i.focus_in_input()||e.metaKey||e.altKey||e.altGraphKey||e.ctrlKey||l===r.KeyCode.SPACE&&!t()||(l===r.KeyCode.SPACE&&t()&&e.preventDefault(),n(u),null!=a&&clearTimeout(a),a=setTimeout(function(){s()},1e3))}Object.defineProperty(t,"__esModule",{value:!0});var o=["/","\\",":","?","*","<",">","|"],a=null;t.handleKeyPress=n}),define("modules/clean/react/files_view/file_list_empty_folder_table",["require","exports","tslib","external/react","spectrum/media_table","spectrum/table"],function(e,t,r,i,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.props.onTTI&&this.props.onTTI()},t.prototype._renderTitle=function(){return i.createElement("h3",{className:"u-font-strong empty-folder-table-title"},this.props.title)},t.prototype._renderSubtitle=function(){var e=this.props,t=e.subtitle,r=e.subtitleLink,n=e.subtitleOnClick;return t&&r?i.createElement("a",{className:"empty-folder-table-subtitle empty-folder-table-link",href:r,onClick:n},t):t?i.createElement("span",{className:"empty-folder-table-subtitle"},t):void 0},t.prototype.render=function(){for(var e=[],t=0;t<this.props.numRowsAbove;t++)e.push(i.createElement(n.MediaRow,{key:-t-1}));for(var r=[],a=Math.max(this.props.totalRows-this.props.numRowsAbove-1,0),t=0;t<a;t++)r.push(i.createElement(n.MediaRow,{key:t+1}));return i.createElement(o.Table,{className:"empty-folder-table"},i.createElement(o.TableHead,null),i.createElement(o.TableBody,null,e,i.createElement(n.MediaRow,{key:0},i.createElement(n.MediaCell,{className:"empty-folder-table-cell",title:this._renderTitle(),subtitle:this._renderSubtitle()})),r))},t.defaultProps={numRowsAbove:2,totalRows:14},t})(i.PureComponent);t.EmptyFolderTable=a}),define("modules/clean/react/files_view/file_list_utils",["require","exports","modules/clean/filetypes","modules/clean/react/files_view/types","modules/clean/react/browse/models","modules/clean/sharing/browse_exports"],function(e,t,r,i,n,o){"use strict";function a(e){var t=e.file,o=e.isSelected,a=e.dropTargetHighlightMode;if(a===i.DropTargetHighlightMode.NONE)return!1;if(!t.is_dir)return!1;if(n.File.isReadOnlySharedFolder(t))return!1;if(t.isDeleted)return!1;switch(a){case i.DropTargetHighlightMode.ALL_FOLDERS:return!0;case i.DropTargetHighlightMode.NONSELECTED_FOLDERS:return!o;case i.DropTargetHighlightMode.NONSELECTED_NONSHARED_FOLDERS:return!o&&t.type!==r.FileTypes.SHARED_FOLDER;case i.DropTargetHighlightMode.NONSELECTED_NONSHARED_NONTEAM_FOLDERS:return!o&&![r.FileTypes.SHARED_FOLDER,r.FileTypes.TEAM_SHARED_FOLDER].includes(t.type)}return!1}function s(e){var t=e.context,i=e.file;e.user;return i.isDeleted||i.is_dir&&o.shouldUsePublicFolderSharing(t.config,i.fq_path)||n.File.isTeamMemberFolder(i)||!n.File.canViewFileMembers(i,t)||i.type===r.FileTypes.SANDBOX}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldFileBeHighlightedDropTarget=a,t.isSharingDisabledForFile=s}),define("modules/clean/react/files_view/keyboard_shortcuts",["require","exports","external/keymaster","external/react-dom","modules/clean/undo","modules/core/browser","modules/core/i18n","modules/core/notify","modules/clean/react/files_view/file_jump","modules/clean/react/no-jquery"],function(e,t,r,i,n,o,a,s,l,u){"use strict";function c(e){r.clearScope(e),r.setScope(T)}function d(e,t){return function(r){e(r)&&(r.preventDefault(),"function"==typeof t&&t(r))}}function p(e){return function(t){return!document.activeElement||document.activeElement===document.body||i.findDOMNode(e).contains(t.target)}}function h(e){c(e),E.remove(e,"keydown"),E.remove(e,"keyup")}function m(e){var t=e.getIsGlobalEvent,i=e.getIsItemEvent,l=e.getSelectedFiles,u=e.isFilesViewList,c=e.isCurrentPathWriteable,p=e.selectAllAction,h=e.deselectAllAction,m=e.onCopyToClipboard,g=e.onDelete,f=e.onPasteFromClipboard,_=e.onShowRename,E=e.onShowHelpMenu,b=e.scope;T=r.getScope(),T!==b&&r.setScope(b);var S=function(){var e=l(),t=e.some(function(e){return e.read_only});if(1===e.size)if(c()&&!t){var r=e.first();r.isDeleted?s.Notify.error(a._("Deleted files can’t be renamed.")):_(r)}else s.Notify.warning(a._("You don’t have permission to rename files in this folder."))},v=function(){var e=l();e.size&&g(e.toArray())},w=function(){n.performUndo()},I=function(){return document.getElementsByClassName("search-bar__text-input")[0].focus()};r("f2",b,d(i,S)),r("/",b,d(t,I)),r("shift+/",b,d(t,function(){return E(!!u)})),r("escape",b,d(t,h)),o.mac?(r("command+a",b,d(t,p)),r("command+c",b,d(i,m)),r("backspace",b,d(i,v)),r("command+v",b,d(t,f)),r("command+z",b,d(t,w))):(r("ctrl+a",b,d(t,p)),r("ctrl+c",b,d(i,m)),r("delete",b,d(i,v)),r("ctrl+v",b,d(t,f)),r("ctrl+z",b,d(t,w)))}function g(e){var t=e.getIsGlobalEvent,i=e.getIsItemEvent,n=e.getSelectedFiles,o=e.isCurrentPathWriteable,a=e.enableContextMenu,s=e.selectAllAction,l=e.deselectAllAction,c=e.onCopyToClipboard,p=e.onDelete,h=e.onNavigateToFileOrFolder,g=e.onNavigateToParentFolder,f=e.onPasteFromClipboard,_=e.onShowRename,T=e.onShowHelpMenu,E=e.openContextMenuAtPosition,b=e.scope;m({getIsGlobalEvent:t,getIsItemEvent:i,getSelectedFiles:n,isFilesViewList:!0,isCurrentPathWriteable:o,selectAllAction:s,deselectAllAction:l,onCopyToClipboard:c,onDelete:p,onPasteFromClipboard:f,onShowRename:_,onShowHelpMenu:T,scope:b});var S=function(){var e=n();1===e.size&&h(e.first())},v=function(){var e=n(),t=e.first();1===e.size&&t.is_dir&&h(t)},w=function(e){if("function"==typeof E&&n().size){var t=u.closestElement(e.target,".browse-file-row--is-selected");if(t){E(t.offsetLeft+200,t.offsetTop+5,t)}}else E(10,10)};r("enter",b,d(i,S)),r("right",b,d(i,v)),r("left",b,d(t,g)),a()&&r("alt+a",b,d(t,w))}function f(e){var t=e.scope,i=e.getIsFileJumping,n=e.onAddFileJumpKeyCode,o=e.onResetFileJump,a=function(e){r.getScope()===t&&l.handleKeyPress(e,i,n,o)};E.add(t,"keypress",a)}function _(e){E.remove(e,"keypress")}Object.defineProperty(t,"__esModule",{value:!0}),t.FILES_VIEW_SHORTCUTS=[{windowsKey:"Enter",macKey:"return",desc:a._("Open file or folder")},{key:"/",desc:a._("Search")},{windowsKey:"Ctrl + a",macKey:"⌘ + a",desc:a._("Select all files")},{windowsKey:"Esc",macKey:"esc",desc:a._("Deselect all files")},{windowsKey:"Ctrl + c",macKey:"⌘ + c",desc:a._("Copy selected file(s)")},{windowsKey:"Ctrl + v",macKey:"⌘ + v",desc:a._("Paste selected file(s) into the current folder")},{key:"F2",desc:a._("Rename selected file")},{windowsKey:"Delete",macKey:"delete",desc:a._("Delete selected file(s)")},{windowsKey:"Ctrl + z",macKey:"⌘ + z",desc:a._("Undo recent move/copy/rename/delete")},{key:"?",desc:a._("Show keyboard shortcuts")}],t.FILES_VIEW_LIST_SHORTCUTS=[{key:"↑",desc:a._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:a._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:a._("Go up a folder")},{key:"→",desc:a._("Open folder")}].concat(t.FILES_VIEW_SHORTCUTS),t.FILES_VIEW_TILE_GRID_SHORTCUTS=[{key:"↑",desc:a._("Select file in previous row (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"↓",desc:a._("Select file in next row (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"←",desc:a._("Select previous file (hold shift to select range)",{comment:"Shift refers to the shift key"})},{key:"→",desc:a._("Select next file (hold shift to select range)",{comment:"Shift refers to the shift key"})}].concat(t.FILES_VIEW_SHORTCUTS);var T="",E=new u.ScopedEventHandlers(document);t.generateGetIsGlobalEvent=p,t.resetFilesViewKeyboardShortcuts=h,t.setupFilesViewKeyboardShortcuts=m,t.setupFilesViewListKeyboardShortcuts=g,t.setupFileJumpKeyboardShortcuts=f,t.resetFileJumpKeyboardShortcuts=_}),define("modules/clean/react/files_view/name_input",["require","exports","tslib","external/classnames","external/react","modules/clean/keycode","modules/clean/react/files_view/types"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(){},l=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setInputRef=function(e){t.inputRef=e},t.handleDragStart=function(e){e.stopPropagation()},t.handleSubmit=function(e){e.preventDefault(),t.submitIfChanged(a.NameInputActionSource.SUBMIT)},t.handleKeyDown=function(e){e.keyCode===o.KeyCode.ESC?(e.preventDefault(),t.props.onCancel({source:a.NameInputActionSource.ESC})):e.keyCode===o.KeyCode.ENTER&&t.handleSubmit(e)},t.handleBlur=function(e){t.submitIfChanged(a.NameInputActionSource.BLUR)},t.handleClick=function(e){e.preventDefault(),t.props.onClick(e)},t}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.inputRef.focus(),window.requestAnimationFrame(function(){var t=e.inputRef.value,r=e.props.isDir?t.length:t.lastIndexOf(".");r<0&&(r=t.length),e.inputRef.setSelectionRange(0,r)})},t.prototype.submitIfChanged=function(e){var t=this.inputRef.value.trim();t===this.props.defaultValue?this.props.onCancel({source:e}):this.props.onSubmit(t)},t.prototype.render=function(){return n.createElement("form",{className:"u-pad-right-xs",onSubmit:this.handleSubmit},n.createElement("input",{ref:this.setInputRef,defaultValue:this.props.defaultValue,className:i("c-input",this.props.className),onBlur:this.handleBlur,onKeyDown:this.handleKeyDown,onDragStart:this.handleDragStart,"aria-label":this.props.label,onClick:this.handleClick}))},t.defaultProps={className:"",onCancel:s,onClick:s,onSubmit:s,idDir:null},t})(n.PureComponent);t.NameInput=l}),define("modules/clean/react/files_view/overflow_menu",["require","exports","tslib","external/react","spectrum/overflow_button","spectrum/popover","modules/core/i18n","external/lodash","modules/clean/react/browse/constants"],function(e,t,r,i,n,o,a,s,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var u;(function(e){e[e.Normal=0]="Normal",e[e.Small=1]="Small"})(u=t.OverflowMenuSize||(t.OverflowMenuSize={}));var c=(function(e){function t(t){var r=e.call(this,t)||this;return r.onClick=function(e){e.preventDefault(),e.stopPropagation(),r.setPopoverContentPosition()},r.handleSelection=function(e){e.performAction()},r.setOverflowMenuRef=function(e){r.overflowMenuContent=e},r.state={popoverContentPosition:"below"},r}return r.__extends(t,e),t.prototype.renderOverflowButton=function(){return i.createElement(n.OverflowButton,{"aria-label":a._("More actions"),className:"browse-overflow-menu-trigger-button",tagName:"span",size:this.props.size===u.Small?"small":"default",variant:this.props.showBorders?"secondary":"borderless"})},t.prototype.setPopoverContentPosition=function(){var e=this.overflowMenuContent.getElementsByClassName("browse-overflow-menu-trigger-button")[0],t=l.OverflowMenuConstants.MENU_ITEM_HEIGHT_PX*this.props.actionItemsGroups[0].length+2*l.OverflowMenuConstants.MENU_MARGIN_PX;this.props.actionItemsGroups.length>1&&(t+=l.OverflowMenuConstants.MENU_ITEM_HEIGHT_PX*this.props.actionItemsGroups[1].length+l.OverflowMenuConstants.MENU_POPOVER_ITEM_GROUP_SEPARATOR_HEIGHT_PX);var r=e.getBoundingClientRect();r.top>t+l.CulledListConstants.DEFAULT_HEADER_HEIGHT_PX&&r.bottom+t>window.innerHeight?this.setState({popoverContentPosition:"above"}):this.setState({popoverContentPosition:"below"})},t.prototype._getMenuItems=function(){var e=this.props.actionItemsGroups;return s.reduce(e,function(e,t,r){var n=t.map(function(e){return i.createElement(o.PopoverContentItem,{className:e.className,key:e.label,value:e,disabled:e.disabled},e.label)});return r?e.concat([i.createElement(o.PopoverItemGroupSeparator,{key:r})],n):n.slice()},[])},t.prototype.render=function(){var e=this.props.attachment,t=this._getMenuItems();return i.createElement("div",{className:"browse-overflow-menu",onClick:this.onClick,onDoubleClick:this.onClick,ref:this.setOverflowMenuRef},i.createElement(o.Popover,{onSelection:this.handleSelection,closeOnSelection:!0},i.createElement(o.PopoverTrigger,{className:"browse-overflow-menu-trigger"},this.renderOverflowButton()),i.createElement(o.PopoverContent,{attachment:e,position:this.state.popoverContentPosition,className:"browse-overflow-menu-content"},t)))},t.defaultProps={attachment:"right"},t})(i.PureComponent);t.FilesViewOverflowMenu=c}),define("modules/clean/react/files_view/star",["require","exports","external/react","modules/core/exception"],function(e,t,r,i){"use strict";function n(t){var n,o,a=t.item,s=t.user,l=t.className,u=t.onStarClick,c=t.isReadOnly,d=t.isTabbing,p=e("modules/clean/react/starred/browse_exports"),h=p.Star,m=p.HOME_RESOURCE_ID_TYPE,g=p.StarredSource;return a.file_id?(n=a.file_id,o=m.ENCODED_FILE_OBJ_ID):a.pad_id?(n=a.pad_id,o=m.PAPER_DOCUMENT_ID):a.folder_id?(n=a.folder_id,o=m.PAPER_FOLDER_ID):(i.assert(!!a.fq_path,"Starrable item is not valid. It requires file_id, pad_id, folder_id or fq_path."),n=a.fq_path,o=m.FQ_PATH),r.createElement("div",{className:l},r.createElement(h,{id:n,key:"star",idType:o,user:s,onStarClick:u,source:g.BROWSE,isReadOnly:c,isTabbing:d}))}Object.defineProperty(t,"__esModule",{value:!0}),t.StarContainer=n}),define("modules/clean/react/files_view/tile_grid",["require","exports","tslib","external/classnames","external/immutable","external/react","spectrum/button","modules/clean/em_string","modules/clean/filepath","modules/core/browser","modules/clean/react/files_view/file_grouper","modules/clean/react/files_view/keyboard_shortcuts","modules/clean/react/browse/models","modules/clean/react/files_view/overflow_menu","modules/clean/react/files_view/tile_label_input","modules/clean/react/files_view/types","modules/clean/react/files_view/constants","modules/clean/react/files_view/drag_and_drop","modules/clean/react/files_view/util","modules/clean/react/files_view/star","modules/clean/react/maestro/tile_grid","modules/clean/react/title_bubble","modules/core/i18n","modules/core/uri","modules/clean/browse_interface"],function(e,t,r,i,n,o,a,s,l,u,c,d,p,h,m,g,f,_,T,E,b,S,v,w,I){"use strict";function L(e,t){var r;return e.thumbnail_url_tmpl&&(r=w.URI.parse(e.thumbnail_url_tmpl),r=r.removeQuery("size").removeQuery("size_mode"),r=r.updateQuery({size:t+"x"+t,size_mode:"2"}).toString()),r}Object.defineProperty(t,"__esModule",{value:!0}),t.getThumbnailUrlForItem=L;var y=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onStarClickCallback=function(e){var r=t.props,i=r.onStarClick,n=r.item,o=n;i&&i(o,e)},t}return r.__extends(t,e),t.prototype.render=function(){var e,t=this.props,r=t.fileRename,i=t.arePostTTIModulesLoaded,n=t.user,a=t.item,u=t.inSelectMode,c=t.createRenameCancelHandler,d=t.createRenameSubmitHandler,h=t.expShowPaperStars,f=t.expUseFqPathForStars,_=a instanceof p.File,T=a,w=a;if(e=_?l.filename(T.fq_path):w.title,_&&r&&l.paths_are_equal(r.file.fq_path,T.fq_path)){if(r.state===g.RenameState.PENDING_INPUT)return o.createElement(m.TileLabelInput,{defaultValue:e,label:e,onCancel:c(T),onSubmit:d(T)});if(r.state===g.RenameState.SAVING_INPUT)return o.createElement(b.TileItemLabelText,{className:"tile-label__text--saving",label:v._("Renaming…")})}var I=s.Emstring.em_snippet(e,14,.5),L=i&&!u&&!p.File.isNoAccessSharedFolder(T),y=o.createElement(b.TileItemLabelText,{key:"label",label:I});e!==I&&(y=o.createElement(S.TitleBubble,{content:e,position:S.TitleBubble.POSITIONS.BOTTOM,className:"tile-label__title-bubble",key:"tooltip"},y));var N=_?this.onStarClickCallback:void 0,C=_&&f?{fq_path:T.fq_path}:a,D=_||h?o.createElement(E.StarContainer,{item:C,user:n,
className:"tile-star",key:"tileStar",onStarClick:N}):null;return o.createElement("span",null,[y,L&&!r&&D])},t})(o.PureComponent);t.TileLabel=y;var N=(function(t){function s(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={inSelectMode:!1,sectionLabels:n.List(),sectionStartIndices:n.List(),selectedIds:n.Set(),totalNumItems:0},e.handleFileViewerUnmount=function(){e.tileGrid&&e.tileGrid.getAndUpdateTileLayout();var t=e.props.selectedFiles.first();t&&e.props.onFocusFile(t.fq_path)},e.createRenameCancelHandler=function(t){return function(){e.props.onRenameCancel(t)}},e.createRenameSubmitHandler=function(t){return function(r){e.props.onRenameSubmit(t,r)}},e.setTileGridRef=function(t){e.tileGrid=t},e.hrefForItem=function(e,t){return t instanceof p.File?I.href_for_file(e,t):t.url},e.getTileItem=function(t,i){var n,s=e.props,u=s.activeDropTarget,c=s.isCreateFolderUIActive,d=s.isPhotosPage,h=s.items,m=s.selection,g=s.user,_=s.viewType,T=e.state.inSelectMode;if(c){if(0===t)return e.getCreateFolderTile();t-=1}var E=h.get(t);if(!E){var b="Placeholder "+t;return{altText:b,id:b,isViewOnly:!0,isDraggable:!1,isSelectable:!1}}var S=E instanceof p.File,w=E,I=E,y=e.createViewFileHandler(w),N=e.createToggleSelectHandler(w),C=y,D=!1,F=!1;S&&(n=e.renderTileOverflowMenu(w,i)),T&&S&&(D=m.selected.last()===w.fq_path,F=m.selected.has(w.fq_path),C=N,S&&(n=o.createElement(a.Button,{className:"tile__action-button--view-file",variant:"secondary",size:"small","aria-label":v._("View File"),onClick:y})));var P=d?void 0:e.renderLabelElement(E),O=S?l.filename(w.fq_path):I.title,R=S?L(w,f.ViewTypeThumbnailSizes[_]):void 0,M=E===u,A=e.hrefForItem(g,E),x={file:w,paper:E instanceof p.Paper?I:void 0,id:S?w.sjid.toString():I.pad_id,labelNode:P,altText:O,thumbnailUrl:R,actionNode:n,onTileAction:C,isDraggable:!1,isFocused:D,isSelectable:S,handleToggleSelect:N,checkboxAriaText:v._("Select tile"),href:A};return d||(x=r.__assign({},x,{isDraggable:!0,onDragEnter:e.createDragEnterHandler(w,F,M),onDragStart:e.createDragStartHandler(w,F,N)})),x},e}return r.__extends(s,t),s.prototype.componentWillMount=function(){this.setState({inSelectMode:this.props.selectedFiles.count()>0}),this.setTotalNumItems(this.props),this.setTileItemsSections(this.props),this.setSelectedTiles(this.props)},s.prototype.componentDidMount=function(){this.setupExternalDragHandler(),this.setupKeyboardShortcuts()},s.prototype.componentWillUnmount=function(){this.props.isPhotosPage||d.resetFileJumpKeyboardShortcuts(f.TILE_GRID_SCOPE),d.resetFilesViewKeyboardShortcuts(f.TILE_GRID_SCOPE),_.cleanupExternalDragHandler(f.TILE_GRID_SCOPE)},s.prototype.componentWillReceiveProps=function(e){e.items===this.props.items&&e.createNewFolderState===this.props.createNewFolderState||this.setTotalNumItems(e),e.selectedFiles!==this.props.selectedFiles&&(this.setSelectedTiles(e),this.setState({inSelectMode:e.selectedFiles.count()>0})),e.activeSortField===this.props.activeSortField&&e.activeSortDirection===this.props.activeSortDirection&&e.sections===this.props.sections&&e.items===this.props.items||this.setTileItemsSections(e)},s.prototype.componentDidUpdate=function(e){(e.createNewFolderState===g.NewFolderCreationState.PENDING_INPUT&&this.props.createNewFolderState===g.NewFolderCreationState.SAVING_INPUT||e.fileRename!==this.props.fileRename||e.items!==this.props.items)&&this.tileGrid.forceUpdate()},s.prototype.setTotalNumItems=function(e){var t=Math.max(e.items.size,e.totalNumItems);e.isCreateFolderUIActive&&(t+=1),this.setState({totalNumItems:t})},s.prototype.setTileItemsSections=function(e){var t;t=e.sections?e.sections:e.activeSortField?c.getSections(e.items,e.activeSortField,e.activeSortDirection):{sectionLabels:[],sectionStartIndices:[]},this.setState({sectionLabels:n.List(t.sectionLabels),sectionStartIndices:n.List(t.sectionStartIndices)})},s.prototype.createToggleSelectHandler=function(e){var t=this,r=e.fq_path;return function(e){e.preventDefault(),e.stopPropagation();var i=t.props.selection;i=i.selected.has(r)?i.update("selected",function(e){return e.delete(r)}):i.update("selected",function(e){return e.add(r)}).set("anchor",r),t.props.onSelectionChange(i)}},s.prototype.renderTileOverflowMenu=function(t,r){var i=this.props,n=i.getOverflowMenuActions,a=i.arePostTTIModulesLoaded,s=0===r?"left":"right";if(a){var l=e("modules/clean/react/files_view/overflow_menu_with_star").OverflowMenuWithStar;return o.createElement(l,{file:t,getOverflowMenuActions:n,attachment:s,size:h.OverflowMenuSize.Small,showBorders:!0})}return null},s.prototype.renderLabelElement=function(e){var t=this.state.inSelectMode,i=this.props,n=i.user,a=i.fileRename,s=i.arePostTTIModulesLoaded,l=i.onStarClick,u=i.expShowPaperStars,c=i.expUseFqPathForStars,d={user:n,fileRename:a,arePostTTIModulesLoaded:s,onStarClick:l,expShowPaperStars:u,expUseFqPathForStars:c};return o.createElement(y,r.__assign({},d,{item:e,inSelectMode:t,createRenameCancelHandler:this.createRenameCancelHandler,createRenameSubmitHandler:this.createRenameSubmitHandler}))},s.prototype.createViewFileHandler=function(e){var t=this;return function(r){if(r.preventDefault(),r.stopPropagation(),"click"===r.type){var i=r;if(0===i.button){var n=t.hrefForItem(t.props.user,e);if(T.hasModifierKey(i))return void u.open_tab(n)}}e instanceof p.File?t.props.onNavigateToFileOrFolder(e,t.handleFileViewerUnmount):e instanceof p.Paper&&t.props.onOpenPaper(e)}},s.prototype.setSelectedTiles=function(e){var t=n.Set().withMutations(function(t){e.selectedFiles.forEach(function(e){t.add(e.sjid.toString())})});this.setState({selectedIds:t})},s.prototype.setupExternalDragHandler=function(){var e=this,t=function(){return!!e.props.isDraggingInternalFiles},r=function(){return!!e.props.isDraggingExternalFiles},i=function(){return e.props.activeDropTarget};_.setupExternalDragHandler(f.TILE_GRID_SCOPE,t,r,this.props.onSetFileUploaderPath,".tile",i,this.props.onSetDropTarget)},s.prototype.setupKeyboardShortcuts=function(){var e=this,t=this.props,r=t.onDelete,i=t.onShowRename,n=t.deselectAll,o=t.getIsCurrentPathWriteable,a=t.getIsFileJumping,s=t.onAddFileJumpKeyCode,l=t.onResetFileJump,u=t.onCopyToClipboard,c=t.onPasteFromClipboard,p=t.selectAll,h=d.generateGetIsGlobalEvent(this),m=h,g=function(){return e.props.selectedFiles};this.props.isPhotosPage||d.setupFileJumpKeyboardShortcuts({scope:f.TILE_GRID_SCOPE,getIsFileJumping:a,onAddFileJumpKeyCode:s,onResetFileJump:l}),d.setupFilesViewKeyboardShortcuts({getIsGlobalEvent:h,getIsItemEvent:m,getSelectedFiles:g,isFilesViewList:!1,isCurrentPathWriteable:o,selectAllAction:p,deselectAllAction:n,onCopyToClipboard:u,onDelete:r,onPasteFromClipboard:c,onShowRename:i,scope:f.TILE_GRID_SCOPE,onShowHelpMenu:function(){return e.props.onOpenKeyboardShortcutModal()}})},s.prototype.createDragEnterHandler=function(e,t,r){var i=this;return function(n){i.props.onDragEnter(n,e,t,r)}},s.prototype.createDragStartHandler=function(e,t,r){var i=this;return function(n){t?i.props.onDragStart(n):(r(n),i.props.onDragStart(n,[e]))}},s.prototype.getCreateFolderTile=function(){var e=this.props,t=e.createNewFolderState,r=e.onNewFolderCancel,i=e.onNewFolderSubmit,n=v._("New folder"),a=o.createElement("div",null);return t===g.NewFolderCreationState.PENDING_INPUT?(n=v._("Folder name"),a=o.createElement(m.TileLabelInput,{label:n,onCancel:r,onSubmit:i})):t===g.NewFolderCreationState.SAVING_INPUT&&(n=v._("Creating new folder…"),a=o.createElement(b.TileItemLabelText,{className:"tile-label__text--saving",label:n})),{altText:n,id:"New folder tile",isDraggable:!1,isSelectable:!1,labelNode:a}},s.prototype.getTileGridRef=function(){return this.tileGrid},s.prototype.render=function(){var e=this.props,t=e.enableMaxHeightGrouping,r=e.viewType,n=i({"file-tile-grid-container":!0,"file-tile-grid-container--show-checkboxes":this.state.inSelectMode});return o.createElement("div",null,o.createElement(b.InfiniteTileGrid,{key:"tileGrid",ref:this.setTileGridRef,totalNumItems:this.state.totalNumItems,containerClass:n,rowClass:"file-tile-row",enableMaxHeightGrouping:t,delayRenderFullTile:!this.props.isCreateFolderUIActive,logTileLoading:!0,numThresholdRows:f.FilesViewTileGridConstants.NUM_THRESHOLD_ROWS,scrollDeltaThreshold:f.FilesViewTileGridConstants.SCROLL_DELTA_THRESHOLD,sectionStartIndices:this.state.sectionStartIndices,sectionLabels:this.state.sectionLabels,showLabels:!this.props.isPhotosPage,contentOffset:136,getTileItem:this.getTileItem,selectedIds:this.state.selectedIds,handleTTI:this.props.onTTI,thumbStore:this.props.thumbStore,onRangeInView:this.props.onRangeInView,tilesPerRow:this.props.tilesPerRow,onTilesPerRowChange:this.props.onTilesPerRowChange,dropTargetHighlightMode:this.props.dropTargetHighlightMode,activeDropTarget:this.props.activeDropTarget,maxTileWidth:f.ViewTypeGridSizes[r],tileHeight:f.ViewTypeGridSizes[r]}))},s.defaultProps={enableMaxHeightGrouping:!1},s})(o.PureComponent);t.FilesViewTileGrid=N}),define("modules/clean/react/files_view/tile_label_input",["require","exports","external/classnames","external/react","modules/clean/react/files_view/name_input"],function(e,t,r,i,n){"use strict";function o(e){var t=r("tile-label-input",e.className),o=e.defaultValue||"",a=function(e){e.stopPropagation(),e.preventDefault()};return i.createElement(n.NameInput,{className:t,defaultValue:o,label:e.label,onCancel:e.onCancel,onClick:a,onSubmit:e.onSubmit})}Object.defineProperty(t,"__esModule",{value:!0}),t.TileLabelInput=o}),define("modules/clean/react/files_view/types",["require","exports"],function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});(function(e){e.ESC="ESC",e.SUBMIT="SUBMIT",e.BLUR="BLUR"})(t.NameInputActionSource||(t.NameInputActionSource={}));(function(e){e.CREATE_FOLDER_INACTIVE="CREATE_FOLDER_INACTIVE",e.PENDING_INPUT="PENDING_INPUT",e.SAVING_INPUT="SAVING_INPUT"})(t.NewFolderCreationState||(t.NewFolderCreationState={}));(function(e){e.PENDING_INPUT="pending-input",e.SAVING_INPUT="saving-input"})(t.RenameState||(t.RenameState={}));(function(e){e.LOADED="LOADED",e.LOADING_FIRST_PAGE="LOADING_FIRST_PAGE",e.LOADING_REMAINING_PAGES="LOADING_REMAINING_PAGES"})(t.LoadingState||(t.LoadingState={}));(function(e){e.FILENAME="FILENAME",e.MODIFIED="MODIFIED",e.CATEGORY="CATEGORY",e.EXTENSION="EXTENSION",e.SIZE="SIZE",e.SHARED_WITH="SHARED_WITH",e.SYNC_SETTING="SYNC_SETTING",e.FILE_COUNTS="FILE_COUNTS"})(t.SortField||(t.SortField={}));(function(e){e.FILENAME="FILES_BY_NAME",e.MODIFIED="FILES_BY_MODIFIED",e.CATEGORY="FILES_BY_CATEGORY",e.EXTENSION="FILES_BY_NAME",e.SIZE="FILES_BY_SIZE",e.SHARED_WITH="FILES_BY_NAME",e.SYNC_SETTING="FILES_BY_SYNC_SETTING",e.FILE_COUNTS="FILES_BY_FILE_COUNTS"})(t.SortLabel||(t.SortLabel={}));(function(e){e.ASCENDING="ASCENDING",e.DESCENDING="DESCENDING"})(t.SortDirection||(t.SortDirection={}));(function(e){e.Grid="GRID_VIEW",e.List="LIST_VIEW",e.LargeGrid="LARGE_GRID_VIEW"})(t.ViewType||(t.ViewType={}));(function(e){e.LOADING="LOADING",e.COMPLETE="COMPLETE",e.NO_ACCESS="NO_ACCESS",e.ERROR="ERROR"})(t.FetchFolderSizeState||(t.FetchFolderSizeState={}));(function(e){e.NONE="NONE",e.ALL_FOLDERS="ALL_FOLDERS",e.NONSELECTED_FOLDERS="NONSELECTED_FOLDERS",e.NONSELECTED_NONSHARED_FOLDERS="NONSELECTED_NONSHARED_FOLDERS",e.NONSELECTED_NONSHARED_NONTEAM_FOLDERS="NONSELECTED_NONSHARED_NONTEAM_FOLDERS"})(t.DropTargetHighlightMode||(t.DropTargetHighlightMode={}))}),define("modules/clean/react/files_view/util",["require","exports"],function(e,t){"use strict";function r(e){return 0===e.button&&!i(e)}function i(e){return e.altKey||e.ctrlKey||e.metaKey}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldHandleClick=r,t.hasModifierKey=i}),define("modules/clean/react/maestro/checkbox",["require","exports","tslib","external/react","external/classnames"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o;(function(e){e[e.Checked=0]="Checked",e[e.PartiallyChecked=1]="PartiallyChecked",e[e.Unchecked=2]="Unchecked"})(o||(o={})),t.CheckboxState=o;var a=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.checkboxState,t=n({"checkbox-button":!0,"partial-checked":e===o.PartiallyChecked,checked:e===o.Checked});return i.createElement("button",{role:"checkbox","aria-checked":e===o.Checked,"aria-label":this.props.ariaLabel,className:t,onClick:this.props.onClick,onMouseDown:this.props.onMouseDown})},t})(i.PureComponent);t.Checkbox=a}),define("modules/clean/react/maestro/tile_element",["require","exports","tslib","external/classnames","external/react","modules/clean/paper_formatting_utils","modules/clean/keycode","modules/clean/react/maestro/checkbox","modules/clean/react/maestro/tile_grid_logger","modules/clean/react/icon/file_folder_icon","modules/clean/user_education/react/user_education_effect"],function(e,t,r,i,n,o,a,s,l,u,c){"use strict";function d(e){var t=e.leftOffset,r=e.tileHeight,i=e.tileWidth,o=e.thumbNode,a=e.labelNode,s={left:t,height:r,width:i,pointerEvents:"none"},l={height:i,width:i};return n.createElement("div",{className:"tile",style:s},n.createElement("div",{className:"tile__thumb-container",style:l},o||n.createElement("div",{className:"tile__preview--placeholder"})),a)}Object.defineProperty(t,"__esModule",{value:!0});var p=function(){return null};t.TilePlaceholder=d;var h=(function(e){function t(i){var n=e.call(this,i)||this;return n.animationRequestIds=[],n.handleThumbnailError=function(){var e=n.props,t=e.onThumbnailError,r=e.tileIndex;n.setState({thumbLoaded:!1}),t&&t(r)},n.focusTile=function(){if(!n.state.isFocused){var e=n.refs.tileThumbContainer;e&&e.focus()}},n.logTileInteractive=function(){var e=!!n.props.thumbnailUrl,t=n.state.thumbLoaded;if(n.props.onThumbnailLoad){var r=window.requestAnimationFrame(function(){var r=window.requestAnimationFrame(function(){n.props.onThumbnailLoad(n.props.tileIndex,e,t)});n.animationRequestIds.push(r)});n.animationRequestIds.push(r)}},n.toggleSelect=function(e){e.preventDefault(),e.stopPropagation(),n.props.handleToggleSelect(e)},n.handleThumbKeyPress=function(e){var t=e.keyCode;t!==a.KeyCode.SPACE&&t!==a.KeyCode.ENTER||(e.preventDefault(),n.props.onTileAction(e))},n.onBlur=function(e){n.setState({isFocused:!1})},n.onFocus=function(e){n.setState({isFocused:!0})},n.state=r.__assign({thumbLoaded:t.isThumbLoaded(i)},n.calcPaperTitleState(i)),n}return r.__extends(t,e),t.prototype.componentDidMount=function(){var e=this;this.props.delayRenderFullTile?this.renderCompleteTileTimeout=setTimeout(function(){e.renderCompleteTileTimeout=0,e.fetchThumbnail()},100):this.fetchThumbnail(),this.logTileInteractive()},t.prototype.componentDidUpdate=function(e,t){!e.isFocused&&this.props.isFocused&&this.focusTile()},t.prototype.componentWillReceiveProps=function(e){if(e.thumbnailUrl!==this.props.thumbnailUrl&&(this.unbindThumbnailIfNeeded(),this.setState({thumbLoaded:t.isThumbLoaded(e)}),this.fetchThumbnail()),t.getPaperTitle(this.props)!==t.getPaperTitle(e)){var r=this.calcPaperTitleState(e);this.setState(r)}},t.getPaperTitle=function(e){return e.paper?e.paper.title:null},t.prototype.calcPaperTitleState=function(e){return e.paper?{paperTitleParts:o.getPaperDocTitleParts(e.paper,"brws-file-name-grid-icon","brws-file-name-grid-icon-emoji",!0)}:{}},t.prototype.componentWillUnmount=function(){this.unbindThumbnailIfNeeded(),this.renderCompleteTileTimeout&&clearTimeout(this.renderCompleteTileTimeout),this.animationRequestIds.forEach(function(e){window.cancelAnimationFrame(e)}),this.animationRequestIds=[]},t.prototype.fetchThumbnail=function(){var e=this,t=this.props,r=t.thumbnailUrl,i=t.thumbStore;if(r){var n=Date.now();this.thumbRequestId=i.bind_url(r,{onSuccess:function(){e.setState({thumbLoaded:!0}),l.InfiniteTileGridLogger.logThumbRTT(Date.now()-n)},onError:function(){e.handleThumbnailError()}})}},t.prototype.unbindThumbnailIfNeeded=function(){var e=this.props.thumbStore;this.state.thumbLoaded&&this.thumbRequestId&&e.unbind_url(this.thumbRequestId),this.setState({thumbLoaded:!1})},t.isThumbLoaded=function(e){var t=e.thumbStore,r=e.thumbnailUrl;return!(!r||!t.get_thumb(r))},t.prototype.renderCheckbox=function(){var e=this.props.isSelected?s.CheckboxState.Checked:s.CheckboxState.Unchecked,t=n.createElement(s.Checkbox,{ariaLabel:this.props.checkboxAriaText,checkboxState:e,onClick:this.toggleSelect});return 0===this.props.tileIndex&&(t=n.createElement(c.UserEducationEffect,{containerName:"FileItemRow",name:"FirstFileSelectCheckbox"},t)),n.createElement("div",{key:"tile-select-checkbox",className:"tile-select-checkbox"},t)},t.prototype.renderActionNode=function(){return n.createElement("div",{key:"tile-action-node",className:"tile__action-button"},this.props.actionNode)},t.prototype.renderThumbnail=function(){var e=this.props,t=e.thumbnailUrl,r=e.thumbStore,i=e.altText,o=e.width;if(this.state.thumbLoaded){var a=r.get_thumb(t);if(a)return n.createElement("img",{alt:i,className:"tile__preview tile__preview--thumb",draggable:!1,src:a,style:{maxHeight:o,maxWidth:o},onError:this.handleThumbnailError})}return this.renderFileIcon()},t.prototype.renderFileIcon=function(){var e=this.props,t=e.file;return e.paper?this.state.paperTitleParts.icon:t?n.createElement(u.FileOrFolderIcon,{className:"tile__preview tile__preview--icon",file:t,variant:"large",showPreview:!1,width:"100%",height:"100%"}):n.createElement("div",{className:"tile__preview--placeholder"})},t.prototype.render=function(){var e=null;this.props.labelNode&&(e=n.createElement("div",{className:"tile-label"},this.props.labelNode));var t=this.props.width+this.props.labelHeight;if(this.props.isViewOnly)return n.createElement(d,{leftOffset:this.props.leftOffset,tileHeight:t,tileWidth:this.props.width,thumbNode:this.renderThumbnail(),labelNode:e});var o={left:this.props.leftOffset,height:t,width:this.props.width},a={height:this.props.width,width:this.props.width},s={className:i("tile",{"tile--is-selected":this.props.isSelected,"tile--focused-in":this.state.isFocused,"tile--is-dragover":this.props.isActiveDropTarget,"tile--is-droppable":this.props.isAvailableDropTarget&&!this.props.isActiveDropTarget}),style:o,draggable:this.props.isDraggable,href:this.props.href,onBlur:this.onBlur,onClick:this.props.onTileAction,onDragEnter:this.props.onDragEnter,onDragStart:this.props.onDragStart,onFocus:this.onFocus},l=n.createElement("div",{ref:"tileThumbContainer",className:"tile__thumb-container",style:a,tabIndex:0,onKeyDown:this.handleThumbKeyPress},this.renderThumbnail());return n.createElement("a",r.__assign({},s),l,this.props.isSelectable&&this.renderCheckbox(),this.renderActionNode(),e)},t.defaultProps={checkboxAriaText:"",delayRenderFullTile:!0,handleToggleSelect:p,isFocused:!1,isSelected:!1,isViewOnly:!1,onDragEnter:p,onDragStart:p,onTileAction:p},t})(n.PureComponent);t.TileElement=h}),define("modules/clean/react/maestro/tile_grid",["require","exports","tslib","external/react","external/react-dom","external/classnames","modules/clean/js_client_stopwatch","spectrum/culled_list","modules/clean/react/maestro/tile_element","modules/clean/react/maestro/tile_grid_logger","modules/clean/react/files_view/file_list_utils"],function(e,t,r,i,n,o,a,s,l,u,c){"use strict";function d(e){var t=null;return function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];if(!t||t.length!==r.length||!t.every(function(e,t){return e===r[t]}))return t=r,e.apply(void 0,r)}}function p(e){var t=e.className,r=e.label;return t=o("tile-label__text",t),i.createElement("div",{className:t},r)}Object.defineProperty(t,"__esModule",{value:!0});t.memoizeCallback=d,t.TileItemLabelText=p;var h=(function(e){function t(t){var r=e.call(this,t)||this;if(r.ttiReported=!1,r.itemRangeByRow=[],r.scrollTileIntoView=function(e,t){var i=r.props.contentOffset||0,n=document.documentElement.scrollTop||document.body.scrollTop,o=Math.floor(t/r.props.tilesPerRow),a=e-i,s=r.getRowHeight(),l=o*s,u=l+s;n<=l&&u<=a+n||(l<n?window.scrollTo(0,l):window.scrollTo(0,u-a))},r.updateOnResize=function(){window.requestAnimationFrame(function(){r.getAndUpdateTileLayout()})},r.handleTTI=function(){r.ttiReported=!0;var e=r.props.handleTTI;e&&e()},r.setLastViewedPage=function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,i=Math.round(t/e);if(r.tileLoadLogger.pruneTrackedPages(),r.tileLoadLogger.logCompletedPages(),!r.tileLoadLogger.pagesCompletedLogging.has(i)&&!r.tileLoadLogger.pagesToLog.has(i))if(i!==r.tileLoadLogger.lastViewedPage){if(r.tileLoadLogger.lastViewedPage=i,r.tileLoadLogger.pageChangeTime=r.tileLoadLogger.getTimeNow(),!r.tileLoadLogger.startTimeByPage.get(i)){var n=r.tileLoadLogger.getTimeNow(),o=r.tileLoadLogger.startTimeByPage.set(i,n);r.tileLoadLogger.startTimeByPage=o}}else{var n=r.tileLoadLogger.getTimeNow();if(n-r.tileLoadLogger.pageChangeTime>1e3){var a=r.tileLoadLogger.pagesToLog.add(i);r.tileLoadLogger.pagesToLog=a}}},r.logTileError=function(e){r.tileLoadLogger&&r.tileLoadLogger.recordTileError(e),r.props.logTileLoading&&u.InfiniteTileGridLogger.logThumbLoadError()},r.logTileLoaded=function(e,t,i){r.tileLoadLogger&&r.tileLoadLogger.recordTileLoaded(e,t,i)},r.renderTileElement=function(e,t,n){if(e<0||e>r.props.totalNumItems)return null;var o=r.props.getTileItem(e,n);if(!o)return i.createElement(l.TilePlaceholder,{leftOffset:t,tileHeight:r.state.tileWidth,tileWidth:r.state.tileWidth});var a=r.ttiReported&&r.props.delayRenderFullTile,s=o.isSelectable&&!!r.props.selectedIds&&r.props.selectedIds.has(o.id),u=o.file&&c.shouldFileBeHighlightedDropTarget({file:o.file,isSelected:s,dropTargetHighlightMode:r.props.dropTargetHighlightMode}),d=u&&o.file===r.props.activeDropTarget;return i.createElement(l.TileElement,{file:o.file,paper:o.paper,key:o.id,onTileAction:o.onTileAction,width:r.state.tileWidth,leftOffset:t,tileIndex:e,labelHeight:o.labelNode?r.props.labelHeight:0,delayRenderFullTile:a,actionNode:o.actionNode,thumbnailUrl:o.thumbnailUrl,labelNode:o.labelNode,altText:o.altText,onThumbnailError:r.props.logTileLoading?r.logTileError:void 0,onThumbnailLoad:r.props.logTileLoading?r.logTileLoaded:void 0,isDraggable:o.isDraggable,onDragEnter:o.onDragEnter,onDragStart:o.onDragStart,isFocused:o.isFocused,isSelectable:o.isSelectable,isSelected:s,isViewOnly:o.isViewOnly,isActiveDropTarget:d,isAvailableDropTarget:u,handleToggleSelect:o.handleToggleSelect,checkboxAriaText:o.checkboxAriaText,thumbStore:r.props.thumbStore,scrollTileIntoView:r.scrollTileIntoView,href:o.href})},r.renderRow=function(e,t,n){var o=r.rowHeights?r.rowHeights[t]:r.getRowHeight();if(!e)return i.createElement(s.CulledItem,{className:r.props.rowClass,height:o,key:t,tagName:"li",topOffset:n});if(!Array.isArray(e))return i.createElement(s.CulledItem,{className:r.props.rowClass,height:o,key:t,tagName:"li",topOffset:n},e);for(var a=e,l=a[0],u=a[1],c=r.state.tileWidth+r.props.tilePadding,d=[],p=4,h=l;h<u;h++)d.push(r.renderTileElement(h,p,d.length)),p+=c;return i.createElement(s.CulledItem,{className:r.props.rowClass,height:o,key:t,tagName:"li",topOffset:n},d)},r.handleRangeInView=d(function(e,t){var i=r.props.onRangeInView;if(i){var n=r.translateRowRangeToItemRange(e,t);i(n[0],n[1])}}),r.props.sectionLabels||r.props.sectionStartIndices){if(!r.props.sectionLabels||!r.props.sectionStartIndices)throw new Error("Included only one of `sectionLabels` or `sectionStartIndices`.");if(r.props.sectionLabels.count()!==r.props.sectionStartIndices.count())throw new Error("sectionLabels and sectionStartIndices must be of same length.")}return r.state={tileWidth:r.props.maxTileWidth},a.JSStopwatch.create_stopwatch_if_not_exist("infinite_tile_grid_logging"),r}return r.__extends(t,e),t.prototype.updateLayout=function(){var e=this;this.animationFrameRequestId=window.requestAnimationFrame(function(){var t=e.getAndUpdateTileLayout();e.props.logTileLoading&&!e.tileLoadLogger&&e.setupTileLogging(e.getRowHeight(),t.tilesPerRow)})},t.prototype.componentDidMount=function(){window.addEventListener("resize",this.updateOnResize),this.updateLayout()},t.prototype.componentWillReceiveProps=function(e){this.tileLoadLogger&&this.tileLoadLogger.updateNumTiles(e.totalNumItems),this.props.maxTileWidth!==e.maxTileWidth&&this.updateLayout()},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.updateOnResize),this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),this.tileLoadLogger&&(clearInterval(this.logTrackingInterval),delete this.tileLoadLogger)},t.prototype.getRowHeight=function(){var e=this.state.tileWidth+this.props.tilePadding;return this.props.showLabels&&(e+=this.props.labelHeight+4),e},t.prototype.getPageHeight=function(){var e=document.documentElement.clientHeight||window.outerHeight,t=this.props.contentOffset||0,r=e-t,i=this.getRowHeight(),n=i*Math.ceil(r/i);return Math.max(n,i)},t.prototype.getAndUpdateTileLayout=function(){var e=this.props.maxTileWidth+this.props.tilePadding,t=n.findDOMNode(this);if(!t||0===t.clientWidth)return{tileWidth:this.state.tileWidth,tilesPerRow:this.props.tilesPerRow};var r=t.clientWidth,i=Math.max(1,Math.floor(r/e)),o=this.props.maxTileWidth;return r%e>1&&(i++,o=r/i-this.props.tilePadding),this.state.tileWidth!==o&&this.setState({tileWidth:o}),this.props.tilesPerRow!==i&&this.props.onTilesPerRowChange(i),{tileWidth:o,tilesPerRow:i}},t.prototype.setupTileLogging=function(e,t){var r=this.getPageHeight(),i=t*Math.ceil(r/e);this.tileLoadLogger=new u.InfiniteTileGridLogger(this.props.totalNumItems,i,t,this.handleTTI);var n=this.tileLoadLogger.pagesToLog.add(0);this.tileLoadLogger.pagesToLog=n;var o=this.tileLoadLogger.getTimeNow(),a=this.tileLoadLogger.startTimeByPage.set(0,o);this.tileLoadLogger.startTimeByPage=a,this.logTrackingInterval=setInterval(this.setLastViewedPage,200,r)},t.prototype.translateRowRangeToItemRange=function(e,t){var r=this.itemRangeByRow;return[r[e][0],r[t][1]]},t.prototype.render=function(){var e=this,t=this.itemRangeByRow;t.length=0;var r=[],n=this.getRowHeight(),o=this.props,a=o.containerClass,l=o.enableMaxHeightGrouping,u=o.numThresholdRows,c=o.scrollDeltaThreshold,d=o.sectionStartIndices,p=o.sectionLabels,h=o.totalNumItems;if(d&&d.count()>0)return this.rowHeights=[],d.forEach(function(o,a){var s=h;a!==d.count()-1&&(s=d.get(a+1)),e.rowHeights.push(32);var l=s-o,u=Math.ceil(l/e.props.tilesPerRow),c=p.get(a),m=i.createElement("div",{className:"tile-section-header"},c);r.push(m),t.push([o,o]);for(var g=0;g<u;g++){var f=o+g*e.props.tilesPerRow,_=Math.min(f+e.props.tilesPerRow,s),T=[f,_];r.push(T),t.push(T),e.rowHeights.push(n)}}),i.createElement(s.CulledList,{enableMaxHeightGrouping:l,items:r,listItemHeight:this.rowHeights,itemBuffer:u,className:a,renderRow:this.renderRow,scrollThreshold:c,shouldUseWindowAsScrollContainer:!0,onRangeInView:this.handleRangeInView});for(var m=Math.ceil(h/this.props.tilesPerRow),g=0;g<m;g++){var f=g*this.props.tilesPerRow,_=Math.min(f+this.props.tilesPerRow,h),T=[f,_];r.push(T),t.push(T)}return i.createElement(s.CulledList,{enableMaxHeightGrouping:l,items:r,listItemHeight:n,itemBuffer:u,className:a,renderRow:this.renderRow,scrollThreshold:c,shouldUseWindowAsScrollContainer:!0,onRangeInView:this.handleRangeInView})},t.defaultProps={enableMaxHeightGrouping:!1,numThresholdRows:10,tilePadding:16,tileHeight:160,maxTileWidth:160,labelHeight:40,logTileLoading:!1,scrollDeltaThreshold:1,showLabels:!0,getTileItem:function(e,t){return null},handleTTI:function(){}},t})(i.PureComponent);t.InfiniteTileGrid=h}),define("modules/clean/react/maestro/tile_grid_logger",["require","exports","external/immutable","modules/clean/js_client_stopwatch","modules/core/browser"],function(e,t,r,i,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=(function(){function e(e,t,i,n){var o=this;this.recordTileError=function(e){var t=Math.floor(e/o.numTilesPerPage);o.pagesWithThumbErrors.has(t)||(o.pagesWithThumbErrors=o.pagesWithThumbErrors.add(t))},this.recordTileLoaded=function(e,t,r){if(r){if(o.thumbsLoaded.has(e))return;o.thumbsLoaded=o.thumbsLoaded.add(e)}else{if(o.iconsLoaded.has(e))return;o.iconsLoaded=o.iconsLoaded.add(e)}var i=!1;i=o.numTiles%o.numTilesPerPage===0?e>=o.numTiles-o.numTilesPerPage:e>=o.numTiles-o.numTiles%o.numTilesPerPage;var n=o.numTilesPerPage;if(i){var a=o.numTiles%o.numTilesPerPage;0!==a&&(n=a)}var s=Math.floor(e/o.numTilesPerPage);if(r||!t){var l=o.numTilesFinalizedByPage,u=l.get(s)||0;o.numTilesFinalizedByPage=l.set(s,u+1)}if(0===s&&o.handleTTI){!(o.iconsLoaded.has(e)&&o.thumbsLoaded.has(e))&&(o.numTilesLoadedOnFirstPage++,o.numTilesLoadedOnFirstPage===n&&o.handleTTI())}r&&(o.pagesWithThumbs.has(s)||(o.pagesWithThumbs=o.pagesWithThumbs.add(s)),o.anyThumbLoadedTimeByPage.get(s)||(o.anyThumbLoadedTimeByPage=o.anyThumbLoadedTimeByPage.set(s,o.getTimeNow())),o.numTilesFinalizedByPage.get(s)===n&&(o.allThumbsLoadedTimeByPage=o.allThumbsLoadedTimeByPage.set(s,o.getTimeNow())))},this.pruneTrackedPages=function(){o.startTimeByPage.entrySeq().forEach(function(e){var t=e[0],r=e[1];!o.pagesToLog.has(t)&&!o.pagesCompletedLogging.has(t)&&o.getTimeNow()-r>2e3&&(o.startTimeByPage=o.startTimeByPage.delete(t))})},this.logCompletedPages=function(){o.pagesToLog.forEach(function(e){var t=o.startTimeByPage.get(e),r=Math.max(o.allThumbsLoadedTimeByPage.get(e),t),i=Math.max(o.anyThumbLoadedTimeByPage.get(e),t);return r&&!o.pagesWithThumbs.has(e)?void o.handlePageCompletedLogging(e):o.pagesWithThumbErrors.has(e)?void o.handlePageCompletedLogging(e):void(t&&r&&i&&(o.logPerfStats(e,t,i,r),o.handlePageCompletedLogging(e)))})},this.numTiles=e,this.numTilesPerPage=t,this.numTilesFinalizedByPage=r.List(),this.numTilesLoadedOnFirstPage=0,this.iconsLoaded=r.Set(),this.thumbsLoaded=r.Set(),this.startTimeByPage=r.Map(),this.allThumbsLoadedTimeByPage=r.Map(),this.anyThumbLoadedTimeByPage=r.Map(),this.pagesWithThumbErrors=r.Set(),this.pagesWithThumbs=r.Set(),this.pagesCompletedLogging=r.Set(),this.pagesToLog=r.Set(),this.handleTTI=n}return e.prototype.getTimeNow=function(){var e=n.performance(),t=-1;return e&&e.now&&(t=e.now()),t},e.prototype.updateNumTiles=function(e){this.numTiles>=e||(this.numTiles=e)},e.prototype.handlePageCompletedLogging=function(e){this.pagesCompletedLogging=this.pagesCompletedLogging.add(e),this.pagesToLog=this.pagesToLog.delete(e),this.startTimeByPage=this.startTimeByPage.delete(e),this.anyThumbLoadedTimeByPage=this.anyThumbLoadedTimeByPage.delete(e),this.allThumbsLoadedTimeByPage=this.allThumbsLoadedTimeByPage.delete(e)},e.logThumbLoadError=function(){i.JSStopwatch.recordTrace("visual_browse_thumb_load_error",{stopwatchName:"infinite_tile_grid_logging",traceTime:0})},e.logThumbRTT=function(e){i.JSStopwatch.recordTrace("visual_browse_thumb_rtt",{stopwatchName:"infinite_tile_grid_logging",traceTime:e})},e.prototype.logPerfStats=function(e,t,r,n){i.JSStopwatch.recordTrace("loaded_any_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:r-t}),i.JSStopwatch.recordTrace("loaded_all_thumbs_page_"+e,{stopwatchName:"infinite_tile_grid_logging",traceTime:n-t})},e})();t.InfiniteTileGridLogger=o}),define("modules/clean/react/outside_event",["require","exports","tslib","external/react","external/prop-types","external/lodash","modules/clean/react/util"],function(e,t,r,i,n,o,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=i.createElement,l=function(e,t,l,u){var c=null!=e.displayName?e.displayName:"UnnamedComponent";return d=(function(i){function n(){var e=null!==i&&i.apply(this,arguments)||this;return e._handleOutsideEvent=function(t){return"function"==typeof e.props[u]?e.props[u](t):void 0},e._handleInsideEvent=function(t){return t.stopPropagation(),"function"==typeof t.nativeEvent.stopImmediatePropagation&&t.nativeEvent.stopImmediatePropagation(),"function"==typeof e.props[l]?e.props[l](t):void 0},e}return r.__extends(n,i),n.prototype.componentDidMount=function(){return document.addEventListener(t,this._handleOutsideEvent,!1)},n.prototype.componentWillUnmount=function(){return document.removeEventListener(t,this._handleOutsideEvent,!1)},
n.prototype.render=function(){return s(e,a.mergeProps(o.omit(this.props,l,u,"children"),(t={},t[l]=this._handleInsideEvent,t)),this.props.children);var t},n})(i.Component),d.displayName="Outside"+t+"Handled"+c,d.propTypes=(p={},p[l]=n.func,p[u]=n.func,p),d;var d,p};t.addOutsideEventHandling=l;var u=l("div","click","onClick","onOutsideClick");t.OutsideClickHandler=u;var c=l("div","mousedown","onMouseDown","onOutsideMouseDown");t.OutsideMouseDownHandler=c}),define("modules/clean/react/path_breadcrumbs",["require","exports","tslib","external/classnames","external/react","spectrum/icon_arrow","spectrum/icon_content","spectrum/popover","modules/clean/em_string","modules/clean/filepath","modules/core/i18n","modules/clean/user_education/react/user_education_effect","modules/clean/user_education/user_education_client","modules/clean/react/icon/icon_helper","modules/clean/react/sprite"],function(e,t,r,i,n,o,a,s,l,u,c,d,p,h,m){"use strict";function g(e,t){return 20-(t?2.625:new l.Emstring(e).length)}function f(e,t,r){for(var i=e.split("/").filter(Boolean),n=[{path:"",icon:"folder_dropbox-small",folderName:t,alt:r}],o=h.spectrum_folder_icon({size:h.ICON_SIZES.SMALL}),a=0;a<i.length;a++)e="/"+i.slice(0,a+1).join("/"),n.push({path:e,folderName:u.filename(e),icon:o,alt:c._("Folder")});if(n.length<3)return{dropdownCrumbs:[],inlineCrumbs:n,root:n[0]};for(var s=n[0]&&n[0].folderName||"",d=g(s,!1),p=n.map(function(e){return new l.Emstring(e.folderName||"").length}),m=1,f=p[n.length-1],a=n.length-2;a>=1&&(f+=1.64,f+=p[a],!(f>d));a--)m+=1;n.length===m+1&&(m+=1);var _=n.length-m;return{dropdownCrumbs:n.slice(0,_),inlineCrumbs:n.slice(_),root:n[0]}}Object.defineProperty(t,"__esModule",{value:!0});t.generateBreadcrumbData=f;var _=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.render=function(){var e=this.props.path,t=this.props,i=t.firstBreadcrumbName,o=t.firstBreadcrumbAlt,a=t.isDraggingInternalFiles,s=t.shouldHighlightDropTargets,l=t.setFileUploaderPath,p=t.getUrlForPath,h=t.setUrl,m=f(e,i,o),_=m.dropdownCrumbs,T=m.inlineCrumbs,b=m.root,v=g(b&&b.folderName||"",_.length>0),w="page-header-text u-l-fl";return T.length>1||_.length>0?n.createElement("span",{className:"brws-path-breadrumbs"},n.createElement("h1",{className:"ax-visually-hidden"},u.filename(e)),n.createElement("nav",{className:w,id:"path-breadcrumbs","aria-label":c._("Folder hierarchy"),role:"navigation"},_.length>0&&n.createElement(S,{crumbs:_,currentPath:e,isDraggingInternalFiles:a,shouldHighlightDropTargets:s,setFileUploaderPath:l,setUrl:h}),T.map(function(t,i){return n.createElement(E,r.__assign({},t,{key:encodeURI(t.path),isOnlyCrumb:0===i&&1===T.length&&0===_.length,index:i,isLastCrumb:i===T.length-1,maxWidth:v,currentPath:e,isDraggingInternalFiles:a,isHighlightedDropTarget:s,setFileUploaderPath:l,getUrlForPath:p,setUrl:h}))}))):n.createElement("span",{className:"brws-path-breadrumbs"},n.createElement("h1",{className:w},n.createElement(d.UserEducationEffect,{containerName:"PathBreadcrumbs",name:"HomeTitle",useSpan:!0},i)))},t.defaultProps={path:"/",isDraggingInternalFiles:!1,shouldHighlightDropTargets:!1,setFileUploaderPath:function(){}},t})(n.PureComponent);t.PathBreadcrumbs=_;var T=function(){return n.createElement("span",null,n.createElement(m.Sprite,{group:"web",name:"chevron",className:"breadcrumb__spacer",alt:""}))},E=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnterBreadcrumb=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.isLastCrumb||r.props.setFileUploaderPath({path:r.props.path}))},r.onDragLeaveBreadcrumb=function(e){e.preventDefault(),r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1})))},r.onDropBreadcrumb=function(){r.setState({isDraggedOver:!1})},r.onDragOverBreadcrumb=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.navigateToFolder=function(e){var t=r.props.path;p.UEClient.sendEvent("BreadCrumbSegment","linkClicked",{path:t}),e.preventDefault(),r.props.setUrl({path:t})},r.eventHandlers={onDragEnter:r.onDragEnterBreadcrumb,onDragLeave:r.onDragLeaveBreadcrumb,onDrop:r.onDropBreadcrumb,onDragOver:r.onDragOverBreadcrumb,onMouseEnter:r.handleMouseEnter,onMouseLeave:r.handleMouseLeave,onMouseUp:r.handleMouseUp},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.getUrlForPath,a=e.path,s=e.index,u=e.isOnlyCrumb,c=e.maxWidth,p=e.isLastCrumb,h=e.isHighlightedDropTarget,m=u?this.props.folderName:l.Emstring.em_snippet(this.props.folderName,c),g={"breadcrumb-segment":!0,"breadcrumb-segment--is-drop-target":!p&&h,"breadcrumb-segment--file-dragged-over":!p&&this.state.isDraggedOver};return p?n.createElement("span",r.__assign({},this.eventHandlers),m):n.createElement("span",r.__assign({className:"breadcrumb-segment__wrapper"},this.eventHandlers),n.createElement(d.UserEducationEffect,{containerName:"BreadCrumbSegment",name:"link-"+s,useSpan:!0},n.createElement("a",{href:t(a).toString(),onClick:this.navigateToFolder,className:i(g)},m)),n.createElement(o.IconArrow,{name:"right"}))},t.defaultProps={isOnlyCrumb:!1,isDraggingInternalFiles:!1,isHighlightedDropTarget:!1},t})(n.Component),b=(function(e){function t(t){var r=e.call(this,t)||this;return r.onDragEnter=function(e){e.preventDefault(),e.target!==r.lastEnteredElement&&(r.lastEnteredElement=e.target,r.dragEnterCount+=1,r.setState({isDraggedOver:!0}),r.props.setFileUploaderPath({path:r.props.path}))},r.onDragLeave=function(e){e.preventDefault(),r.lastEnteredElement=null,r.dragEnterCount-=1,r.dragEnterCount<1&&(r.dragEnterCount=0,r.state.isDraggedOver&&(r.props.setFileUploaderPath({path:r.props.currentPath}),r.setState({isDraggedOver:!1})))},r.onDrop=function(e){r.setState({isDraggedOver:!1})},r.onDragOver=function(e){e.preventDefault(),e.stopPropagation()},r.handleMouseEnter=function(){r.props.isDraggingInternalFiles&&r.setState({isDraggedOver:!0})},r.handleMouseLeave=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1})},r.handleMouseUp=function(){r.state.isDraggedOver&&r.setState({isDraggedOver:!1}),r.props.isDraggingInternalFiles&&!r.props.isLastCrumb&&r.props.closeFunc()},r.state={isDraggedOver:!1},r}return r.__extends(t,e),t.prototype.componentDidMount=function(){this.dragEnterCount=0,this.lastEnteredElement=null},t.prototype.render=function(){var e=this.props,t=e.icon,o=e.alt,l=e.folderName,u={"breadcrumb-menu-item":!0,"breadcrumb-menu-item--is-drop-target":this.props.isHighlightedDropTarget,"breadcrumb-menu-item--file-dragged-over":this.state.isDraggedOver},c=n.createElement("span",{title:l,className:"breadcrumb-menu-item-wrapper"},n.createElement("span",{className:"breadcrumb-menu-item-icon"},n.createElement(a.IconContent,{name:t,alt:o})),n.createElement("span",{className:"breadcrumb-menu-item-text"},l));return n.createElement(s.PopoverContentItem,r.__assign({value:this.props.path,className:i(u)},{onDragEnter:this.onDragEnter,onDragLeave:this.onDragLeave,onDrop:this.onDrop,onDragOver:this.onDragOver,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onMouseUp:this.handleMouseUp}),c)},t.defaultProps={isHighlightedDropTarget:!1,closeFunc:function(){},alt:"",isDraggingInternalFiles:!1},t})(n.Component),S=(function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={menuVisible:!1},t.onDragEnter=function(e){e.preventDefault(),t.setState({menuVisible:!0})},t.onMouseEnter=function(e){t.props.isDraggingInternalFiles&&(e.preventDefault(),t.setState({menuVisible:!0}))},t.onCrumbSelected=function(e){t.props.setUrl({path:e})},t.onPopoverToggle=function(e){var r=e.isOpen;t.setState({menuVisible:r})},t.onClose=function(){t.onPopoverToggle({isOpen:!1})},t}return r.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props.crumbs.slice().reverse(),r=this.props,i=r.currentPath,o=r.shouldHighlightDropTargets,l=r.isDraggingInternalFiles,u=r.setFileUploaderPath,d=c._("Show parent folders (descending)"),p=n.createElement(a.IconContent,{name:"folder_dropdown-small",alt:d,className:"breadcrumb-menu-icon"});return n.createElement("div",{onDragOver:this.onDragEnter,onMouseEnter:this.onMouseEnter},n.createElement(s.Popover,{onSelection:this.onCrumbSelected,onMenuToggle:this.onPopoverToggle,className:"breadcrumb-dropdown-container"},n.createElement(s.PopoverTrigger,null,n.createElement("button",{className:"u-unbutton breadcrumb-overflow-button u-l-fl"},p)),n.createElement(s.PopoverContent,{isRevealed:this.state.menuVisible},t.map(function(t){return n.createElement(b,{key:encodeURI(t.path),path:t.path,icon:t.icon,alt:t.alt,folderName:t.folderName,currentPath:i,isHighlightedDropTarget:o,isDraggingInternalFiles:l,setFileUploaderPath:u,closeFunc:e.onClose})})),n.createElement(T,null)))},t.defaultProps={shouldHighlightDropTargets:!1,isDraggingInternalFiles:!1},t})(n.Component)}),define("modules/clean/react/selection",["require","exports","tslib","external/immutable"],function(e,t,r,i){"use strict";function n(e,t){return new o({selected:e?i.OrderedSet(e):i.OrderedSet(),anchor:t||(e?e[0]:null)})}Object.defineProperty(t,"__esModule",{value:!0});var o=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t})(i.Record({selected:null,anchor:null},"Selection"));t.Selection=o,t.createSelection=n}),define("modules/clean/sharing/browse_exports",["require","exports","tslib","modules/core/browser","modules/constants/sharing","modules/clean/sharing/gating_util","modules/clean/sharing/async_share_modal_util","modules/clean/sharing/public_folder/public_folder","modules/clean/sharing/wizard/async_wizard_modals"],function(e,t,r,i,n,o,a,s,l){"use strict";function u(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];e(["modules/clean/sharing/shared_content_link_mount_folder"],function(e){e.mountSharedFolder.apply(void 0,t)})}function c(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return r.__awaiter(this,void 0,void 0,function(){return r.__generator(this,function(r){return[2,new Promise(function(r,i){e(["modules/clean/sharing/ui_util"],function(e){r(e.genContentManagerBridgeUri.apply(void 0,t))},i)})]})})}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return[4,c.apply(void 0,e)];case 1:return t=r.sent(),i.open_tab(t.toString()),[2]}})})}function p(t,r,i,n,o,a,s){e(["modules/clean/sharing/cdm_new_folder_modal"],function(e){e.showCdmNewFolderModal(t,r,i,n,o,a,s)})}function h(t){return r.__awaiter(this,void 0,void 0,function(){var i;return r.__generator(this,function(r){switch(r.label){case 0:return[4,new Promise(function(t,r){e(["modules/clean/sharing/cdm_new_folder_modal_util"],t,r)})];case 1:return i=r.sent(),i.showAppropriateNewFolderModalForCdmUser(t),[2]}})})}function m(){return r.__awaiter(this,void 0,void 0,function(){var t;return r.__generator(this,function(r){switch(r.label){case 0:return n.SHARING_EXPERIMENTS.ENABLE_INVITE_POPUP?[4,new Promise(function(t,r){e(["modules/clean/sharing/invite_prompt_modal"],t,r)})]:[3,2];case 1:t=r.sent().maybeShowInvitePromptModal,t("create-folder-success"),r.label=2;case 2:return[2]}})})}Object.defineProperty(t,"__esModule",{value:!0}),t.asyncMountSharedFolder=u,t.asyncGoToContentManagerForPath=d,t.asyncShowCdmNewFolderModal=p,t.asyncShowAppropriateNewFolderModalForCdmUser=h,t.asyncShowInvitePromptModal=m,t.GoldenGate=o.GoldenGate,t.asyncShowShareModal=a.asyncShowShareModal,t.asyncShowNewFolderShareModal=a.asyncShowNewFolderShareModal,t.asyncShowPrefilledShareModal=a.asyncShowPrefilledShareModal,t.asyncShowSharedContentLinkSyncModal=a.asyncShowSharedContentLinkSyncModal,t.makePublicFolderLink=s.makePublicFolderLink,t.shouldUsePublicFolderSharing=s.shouldUsePublicFolderSharing,t.showPublicFolderLinkModal=s.showPublicFolderLinkModal,t.asyncShowShareAFolderWizardModal=l.asyncShowShareAFolderWizardModal}),define("modules/clean/sharing/gating_util",["require","exports","modules/constants/sharing"],function(e,t,r){"use strict";function i(e){return r.TRUELINK.NO_COMMENT_ENABLED&&!!(null!=e?r.TRUELINK.NO_COMMENT_ENABLED[e.id]:void 0)}Object.defineProperty(t,"__esModule",{value:!0}),t.GoldenGate={hasNewOwnershipModel:function(e){return Boolean(r.GOLDEN_GATE.HAS_NEW_OWNERSHIP_MODEL[e])},hasContentManagerAndSuperAdmin:function(e){return Boolean(r.GOLDEN_GATE.HAS_CONTENT_MANAGER_AND_SUPER_ADMIN[e])},hasContentManagerActionsDisabled:function(e){return Boolean(r.GOLDEN_GATE.HAS_CONTENT_MANAGER_ACTIONS_DISABLED[e])},hasContentManagerCdm:function(e){return Boolean(r.GOLDEN_GATE.HAS_CONTENT_MANAGER_CDM[e])},hasContentManagerFolderRestore:function(e){return Boolean(r.GOLDEN_GATE.CAN_RESTORE_FOLDERS_IN_CM[e])},useSetAccessInheritanceAPI:function(e){return Boolean(r.GOLDEN_GATE.CDM_USE_SET_ACCESS_INHERITANCE_API[e])},SHARING_TOTAL_LIMIT:r.GOLDEN_GATE.SHARING_TOTAL_LIMIT},t.isUserNoCommentEnabled=i}),define("modules/clean/sharing/public_folder/public_folder",["require","exports","modules/core/uri","modules/constants/public_folder_constants"],function(e,t,r,i){"use strict";function n(e,t){if(e.publicAppToken)return t;if(!e.isPublicFolderEnabled)return null;var r=(e.publicFolderFqPath||"/public").toLowerCase(),i=t.toLowerCase();return i===r?"/":i.startsWith(r+"/")?t.substring(r.length):null}function o(e,t){return null!=n(e,t)}function a(e,t,o,a){if(a)return null;var s,l=n(t,o);if(s=i.SHOULD_REDIRECT_URL?"u"+e+".dl.dropboxusercontent.com":"dl.dropboxusercontent.com",null!=l){var u=new r.URI({scheme:"https",authority:s});return t.publicAppToken?(u.setPath("/spa/"+t.publicAppToken+l+"/data"),u.toString()):(u.setPath("/u/"+e+l),u.toString())}return null}function s(t){return new Promise(function(r,i){e(["external/react","modules/clean/react/modal","modules/clean/sharing/public_folder/modal"],function(e,i,n){var o=i.Modal,a=n.CopyPublicLinkModal;o.showInstance(e.createElement(a,{publicLink:t})),r()})})}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUsePublicFolderSharing=o,t.makePublicFolderLink=a,t.showPublicFolderLinkModal=s});
//# sourceMappingURL=pkg-browse-and-photos.min.js-vflFLYDPc.map